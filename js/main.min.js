!function(){"use strict";window.addEventListener("DOMContentLoaded",(t=>{document.body.classList.remove("preload")}));const t=document.querySelectorAll("[data-outside]"),e="is-active";function n(t,e){t.width=e.clientWidth,t.height=e.clientHeight}t.forEach((t=>{!function(t){if(!t)return;const n=document.getElementById(t.dataset.outside);if(!n)return;function r(){t.classList.toggle(e),n.classList.toggle(e),t.classList.contains(e)?document.addEventListener("click",a):document.removeEventListener("click",a)}function a(e){n.contains(e.target)||t.contains(e.target)||(r(),document.removeEventListener("click",a))}t.addEventListener("click",r);const s=n.querySelector("[data-close]");s&&s.addEventListener("click",(()=>{t.classList.remove(e),n.classList.remove(e),document.removeEventListener("click",a)}))}(t)}));const r=(t,e)=>{if(!t||!e)return;const r={fftSize:e.dataset.fftSize||2048,numBars:e.dataset.bars||40,maxHeight:e.dataset.maxHeight||255},a=new AudioContext,s=a.createMediaElementSource(t),i=a.createAnalyser();s.connect(i),s.connect(a.destination);const o=new Uint8Array(i.frequencyBinCount),c=function(t){const e=document.createElement("canvas");return e.setAttribute("id","visualizerCanvas"),e.setAttribute("class","visualizer-item"),t.appendChild(e),e.width=t.clientWidth,e.height=t.clientHeight,e}(e),l=c.getContext("2d"),d=()=>{n(c,e),i.getByteFrequencyData(o),r.fftSize&&(i.fftSize=r.fftSize),l.clearRect(0,0,c.width,c.height);for(let t=0;t<r.numBars;t++){const e=Math.floor((t+10)*(t<r.numBars/2?2:1)),n=o[e],a=Math.max(4,n||0)+r.maxHeight/255,s=c.width/r.numBars,i=t*s,d=c.height-a;l.fillStyle="white",l.fillRect(i,d,s-2,a)}requestAnimationFrame(d)};d(),window.addEventListener("resize",(()=>{n(c,e)}))},a={},s={play:'<svg class="i i-play" viewBox="0 0 24 24"><path d="m7 3 14 9-14 9z"></path></svg>',pause:'<svg class="i i-pause" viewBox="0 0 24 24"><path d="M5 4h4v16H5Zm10 0h4v16h-4Z"></path></svg>',facebook:'<svg class="i i-facebook" viewBox="0 0 24 24"><path d="M17 14h-3v8h-4v-8H7v-4h3V7a5 5 0 0 1 5-5h3v4h-3q-1 0-1 1v3h4Z"></path></svg>',twitter:'<svg class="i i-x" viewBox="0 0 24 24"><path d="m3 21 7.5-7.5m3-3L21 3M8 3H3l13 18h5Z"></path></svg>',instagram:'<svg class="i i-instagram" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"></circle><rect width="20" height="20" x="2" y="2" rx="5"></rect><path d="M17.5 6.5h0"></path></svg>',youtube:'<svg class="i i-youtube" viewBox="0 0 24 24"><path d="M1.5 17q-1-5.5 0-10Q1.9 4.8 4 4.5q8-1 16 0 2.1.3 2.5 2.5 1 4.5 0 10-.4 2.2-2.5 2.5-8 1-16 0-2.1-.3-2.5-2.5Zm8-8.5v7l6-3.5Z"></path></svg>',tiktok:'<svg class="i i-tiktok" viewBox="0 0 24 24"><path d="M22 6v5q-4 0-6-2v7a7 7 0 1 1-5-6.7m0 6.7a2 2 0 1 0-2 2 2 2 0 0 0 2-2V1h5q2 5 6 5"></path></svg>',whatsapp:'<svg class="i i-whatsapp" viewBox="0 0 24 24"><circle cx="9" cy="9" r="1"></circle><circle cx="15" cy="15" r="1"></circle><path d="M8 9a7 7 0 0 0 7 7m-9 5.2A11 11 0 1 0 2.8 18L2 22Z"></path></svg>',telegram:'<svg class="i i-telegram" viewBox="0 0 24 24"><path d="M12.5 16 9 19.5 7 13l-5.5-2 21-8-4 18-7.5-7 4-3"></path></svg>',tv:'<svg class="i i-tv" viewBox="0 0 24 24"><rect width="22" height="15" x="1" y="3" rx="3"></rect><path d="M7 21h10"></path></svg>',ios:'<svg class="i i-apple" viewBox="0 0 24 24"><path d="M12 3q2 0 2-2-2 0-2 2M8 6C0 6 3 22 8 22q2 0 3-.5t2 0q1 .5 3 .5 3 0 4.5-6a1 1 0 0 1-.5-7.5Q19 6 16 6q-1 0-2.5.5t-3 0Q9 6 8 6"></path></svg>',android:'<svg class="i i-google-play" viewBox="0 0 24 24"><path d="M6.8 2.2a2.5 2.5 0 0 0-3.8 2v15.6a2.5 2.5 0 0 0 3.8 2L21 13.7a2 2 0 0 0 0-3.4ZM3.2 3.5l12.8 13m-12.8 4L16 7.5"></path></svg>'},i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAA1JREFUGFdj+P//PxcACQYDCF0ysWYAAAAASUVORK5CYII=",o=(t,e)=>t.replace(/100x100/,e),c=async(t,e,n,r)=>{let s;s=null===t||t===e?`${e} - ${e}`:`${t} - ${e}`;const i=s.toLowerCase();if(a[i])return a[i];const o=`https://api.streamafrica.net/new.search.php?query=${encodeURIComponent(s)}&service=spotify`,c=await fetch(o);if("LA JEFA GREENVILLE"===e||403===c.status){const s={title:e,artist:t,art:n,cover:r,stream_url:"#not-found"};return a[i]=s,s}const l=c.ok?await c.json():{};if(!l.results||0===l.results.length){const s={title:e,artist:t,art:n,cover:r,stream_url:"#not-found"};return a[i]=s,s}const d=l.results,u={title:d.title||e,artist:d.artist||t,thumbnail:d.artwork||n,art:d.artwork||n,cover:d.artwork||r,stream_url:d.stream_url||"#not-found"};return a[i]=u,u},l=async(t,e,n,r)=>{let s;s=t===e?`${e}`:`${t} - ${e}`;const i=s.toLowerCase();if(a[i])return a[i];const c=await fetch(`https://itunes.apple.com/search?limit=1&term=${encodeURIComponent(s)}`);if(403===c.status){return{title:e,artist:t,art:n,cover:r,stream_url:"#not-found"}}const l=c.ok?await c.json():{};if(!l.results||0===l.results.length){return{title:e,artist:t,art:n,cover:r,stream_url:"#not-found"}}const d=l.results[0],u={title:d.trackName||e,artist:d.artistName||t,thumbnail:d.artworkUrl100||n,art:d.artworkUrl100?o(d.artworkUrl100,"600x600"):n,cover:d.artworkUrl100?o(d.artworkUrl100,"1500x1500"):r,stream_url:"#not-found"};return a[i]=u,u};async function d({artist:t,title:e,art:n,cover:r,server:a}){let s={};return s="spotify"===a.toLowerCase()?await c(t,e,n,r):await l(t,e,n,r),s}const u=async(t,e)=>{try{const n=await fetch(`https://api.vagalume.com.br/search.php?apikey=1637b78dc3b129e6843ed674489a92d0&art=${encodeURIComponent(t)}&mus=${encodeURIComponent(e)}`),r=await n.json();if("exact"===r.type||"aprox"===r.type){return r.mus[0].text}return"Not found lyrics"}catch(t){return console.error("Error fetching lyrics:",t),"Not found lyrics"}};function m(t){return t.replace(/^\d+\.\)\s/,"").replace(/<br>$/,"")}const p=document.querySelector(".player-button-play"),h=document.querySelector(".visualizer"),v=new Audio;v.crossOrigin="anonymous";let g=!1;function y(t,e=null){e&&(t.src=e),g||(r(t,h),g=!0),t.load(),t.play(),p.innerHTML=s.pause,p.classList.add("is-active"),document.body.classList.add("is-playing")}function f(t){t.pause(),p.innerHTML=s.play,p.classList.remove("is-active"),document.body.classList.remove("is-playing")}null!==p&&p.addEventListener("click",(async()=>{v.paused?y(v):f(v)}));const w=document.querySelector(".player-volume"),L=document.querySelector(".player-range-fill"),E=document.querySelector(".player-range-wrapper"),A=document.querySelector(".player-range-thumb"),b=localStorage.getItem("volume")||100;function x(t){L.style.height=`${t}%`}function S(t){const e=t/100*(E.offsetHeight-A.offsetHeight);A.style.bottom=`${e}px`}function q(t){w.value=t,x(t),S(t),localStorage.setItem("volume",t),v.volume=t/100}function C(t){const e=w.getBoundingClientRect();let n=(t.clientY-e.top)/w.offsetWidth*100;n=100-n,n=Math.max(0,Math.min(100,n));q(Math.round((w.max-w.min)*(n/100))+parseInt(w.min))}null!==w&&(q(b),w.addEventListener("input",(t=>{q(t.target.value)})),A.addEventListener("mousedown",(()=>{document.addEventListener("mousemove",C)}))),document.addEventListener("mouseup",(()=>{document.removeEventListener("mousemove",C)})),window.addEventListener("resize",(()=>{const t=w.value;x(t),S(t)}));const k=document.querySelector(".song-now"),M=document.getElementById("stations"),H=document.querySelector(".station-name"),_=document.querySelector(".station-description"),B=document.querySelector(".header-logo-img"),$=document.querySelector(".player-artwork img:first-child"),T=document.querySelector(".player-cover-image"),I=document.querySelectorAll(".player-social"),U=document.querySelector(".footer-app"),R=document.querySelector(".online-tv"),z=document.getElementById("modal-tv"),F=document.querySelector(".player-program"),j=document.getElementById("lyrics"),O=document.getElementById("history"),W='<div class="history-item flex items-center g-0.75">\n<div class="history-image flex-none">\n  <img src="{{art}}" width="80" height="80">\n</div>\n<div class="history-meta flex column">\n  <span class="color-title fw-500 truncate-line">{{song}}</span>\n  <span class="color-text truncate-line">{{artist}}</span>\n</div>\n<a href="{{stream_url}}" class="history-spotify" target="_blank" rel="noopener">\n  <svg class="i i-spotify" viewBox="0 0 24 24">\n    <circle cx="12" cy="12" r="11"></circle>\n    <path d="M6 8q7-2 12 1M7 12q5.5-1.5 10 1m-9 3q4.5-1.5 8 1"></path>\n  </svg>\n</a>\n</div>',Z=window?.streams?.timeRefresh||1e4;let N,D;function Q(t){I&&I.forEach((t=>{t.innerHTML=""})),U&&(U.innerHTML=""),F&&(F.innerHTML=""),R&&(R.innerHTML=""),B.src=t.logo,$.src=t.album,T.src=t.cover||t.album,H.textContent=t.name,_.textContent=t.description,t.social&&I.length&&I.forEach((e=>{Object.keys(t.social).forEach((n=>{e.appendChild(function(t,e){const n=document.createElement("a");return n.classList.add("player-social-item"),n.href=t,n.target="_blank",n.innerHTML=s[e],n}(t.social[n],n))}))})),t.apps&&U&&Object.keys(t.apps).forEach((e=>{U.appendChild(function(t,e){const n=document.createElement("a");return n.classList.add("player-apps-item"),n.href=t,n.target="_blank",n.innerHTML=`<img src="assets/app/${e}.svg" alt="${e}" height="48" width="${"ios"===e?"143":"163"}">`,n}(t.apps[e],e))})),t.program&&F&&function(t){if(!t)return;if(t.time){const e=document.createElement("div"),n=document.createElement("span");e.classList.add("player-program-time-container"),n.classList.add("player-program-badge"),n.textContent="On Air",e.appendChild(n);const r=document.createElement("span");r.classList.add("player-program-time"),r.textContent=t.time,e.appendChild(r),F.appendChild(e)}if(t.name){const e=document.createElement("span");e.classList.add("player-program-name"),e.textContent=t.name,F.appendChild(e)}if(t.description){const e=document.createElement("span");e.classList.add("player-program-description"),e.textContent=t.description,F.appendChild(e)}}(t.program),t.tv_url&&R&&function(t){const e=document.createElement("button");e.classList.add("player-button-tv","btn"),e.innerHTML=s.tv+"Tv en vivo",e.addEventListener("click",(()=>{z.classList.add("is-active"),f(v);const e=z.querySelector(".modal-body-video"),n=z.querySelector("[data-close]"),r=document.createElement("iframe");r.src=t,r.allowFullscreen=!0,e.appendChild(r),n.addEventListener("click",(()=>{z.classList.remove("is-active"),r.remove()}))})),R.appendChild(e)}(t.tv_url)}function V(t,e,n){M&&(M.innerHTML="",t.forEach((async(t,r)=>{const a=document.createDocumentFragment(),s=function(t,e,n,r){const a=document.createElement("button");a.classList.add("station"),a.innerHTML=`<img class="station-img" src="${t.album}" alt="station" height="160" width="160">`,a.dataset.index=e,a.dataset.hash=t.hash,n.stream_url===t.stream_url&&(a.classList.add("is-active"),D=a);return a.addEventListener("click",(()=>{if(a.classList.contains("is-active"))return;D&&D.classList.remove("is-active");const e=document.querySelector(".player-station img:first-child");e&&(e.src=t.album),a.classList.add("is-active"),D=a,Q(t),y(v,t.stream_url),O&&(O.innerHTML=""),"function"==typeof r&&r(t)})),a}(t,r,e,n);a.appendChild(s),M.appendChild(a)})))}function Y(t){const e=k.querySelector(".song-title"),n=document.querySelectorAll(".song-name"),r=document.querySelectorAll(".song-artist"),a=document.querySelector(".player-modal-image");if(n.forEach((e=>{e.textContent=t.title})),r.forEach((e=>{e.textContent=t.artist})),e.classList.remove("is-scrolling"),e.removeAttribute("style"),e.scrollWidth>e.offsetWidth){e.classList.add("is-scrolling");const t=e.scrollWidth-e.offsetWidth,n=t/10;e.setAttribute("style",`--text-scroll: -${t}px; --text-scroll-duration: ${n}s`)}else e.classList.remove("is-scrolling"),e.removeAttribute("style");const s=document.querySelector(".player-artwork"),i=document.querySelector(".player-artwork-mini");if(s){const e=document.createElement("img");e.src=t.art,e.width=600,e.height=600,a.src=t.art,e.addEventListener("load",(()=>{s.appendChild(e);const t=new ColorThief;var n;(n=e.src,new Promise(((t,e)=>{const r=document.createElement("img");r.crossOrigin="Anonymous",r.src=`https://images.weserv.nl/?url=${n}`,r.onload=()=>t(r),r.onerror=e}))).then((e=>{!function(t,e){const n=document.documentElement,r=document.querySelector("meta[name=theme-color]");t.complete?(n.setAttribute("style",`--accent: rgb(${e.getColor(t)})`),r.setAttribute("content",`rgb(${e.getColor(t)})`)):t.addEventListener("load",(function(){n.setAttribute("style",`--accent: rgb(${e.getColor(t)})`),r.setAttribute("content",`rgb(${e.getColor(t)})`)}))}(e,t)})),setTimeout((()=>{s.querySelectorAll("img").forEach((t=>{t.style.transform=`translateX(${-t.width}px)`,t.addEventListener("transitionend",(()=>{s.querySelectorAll("img:not(:last-child)").forEach((t=>{t.remove()})),t.style.transition="none",t.style.transform="none",setTimeout((()=>{t.removeAttribute("style")}),1e3)}))}))}),100)}))}if(i&&(i.src=t.art),T){const e=new Image;e.src=t.cover||t.art,e.addEventListener("load",(()=>{T.style.opacity=0,T.addEventListener("transitionend",(()=>{T.src=t.cover||t.art,T.style.opacity=1}))}))}}function P(t,e,n){if(!O)return;if(O.innerHTML=W.replace("{{art}}",i).replace("{{song}}","Cargando historial...").replace("{{artist}}","Artista").replace("{{stream_url}}","#not-found"),!t)return;const r=(t=t.slice(0,10)).map((async t=>{const{artist:r,song:a}=t,{album:s,cover:i}=e,o=await d({artist:r,title:a,art:s,cover:i,server:n});return W.replace("{{art}}",o.thumbnail||o.art).replace("{{song}}",o.title).replace("{{artist}}",o.artist).replace("{{stream_url}}",o.stream_url)}));Promise.all(r).then((t=>{const e=document.createDocumentFragment();t.forEach((t=>{e.appendChild(function(t){const e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild}(t))})),O.innerHTML="",O.appendChild(e)})).catch((t=>{console.error("Error:",t)}))}!function(){let t,e;const n=(window.streams||{}).stations;function r(n){e&&clearTimeout(e),N.stream_url!==n.stream_url&&(N=n);const a=N.server||"itunes",s=N.api||"https://api.streamafrica.net/metadata/index.php?z="+encodeURIComponent(n.stream_url);fetch(s).then((t=>t.json())).then((async e=>{const n=function(t){let e,n;return t.songtitle&&t.songtitle.includes(" - ")?(e=t.songtitle.split(" - ")[0],n=t.songtitle.split(" - ")[1]):t.now_playing?(e=t.now_playing.song.title,n=t.now_playing.song.artist):t.artist&&t.title?(e=t.title,n=t.artist):t.currenttrack_title?(e=t.currenttrack_title,n=t.currenttrack_artist):t.title&&t.djprofile&&t.djusername?(e=t.title.split(" - ")[1],n=t.title.split(" - ")[0]):(e=t.currentSong,n=t.currentArtist),{title:e,artist:n}}(e),r=n.title;if(t!==r){t=r;let s=n.artist;const i=N.album,o=N.cover,c=function(t){let e,n;return(t.song_history||t.history||t.songHistory||[]).map((r=>(t.song_history?(e=r.song.artist,n=r.song.title):t.history?(e=m(r.split(" - ")[0]||r),n=m(r.split(" - ")[1]||r)):t.songHistory&&(e=r.artist,n=r.title),{artist:e,song:n}))).slice(0,4)}(e);s=r===s?null:s;const l=await d({artist:s,title:r,art:i,cover:o,server:"itunes"});Y(l),function(t){const{title:e,artist:n,album:r,art:a}=t;"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:e,artist:n,album:r,artwork:[{src:a,sizes:"512x512",type:"image/png"}]}),navigator.mediaSession.setActionHandler("play",(()=>{y()})),navigator.mediaSession.setActionHandler("pause",(()=>{f()})))}(l),function(t,e){j&&u(t,e).then((t=>{const e=document.createElement("p");e.innerHTML=t.replace(/\n/g,"<br>"),j.innerHTML="",j.appendChild(e)})).catch((t=>{console.error("Error:",t)}))}(l.artist,l.title),P(c,N,a)}})).catch((t=>console.log(t))),e=setTimeout((()=>{r(n)}),Z)}N=n[0],Q(N),v.src=N.stream_url,r(N),V(n,N,(t=>{r(t)}));const a=document.querySelector(".player-button-forward-step"),s=document.querySelector(".player-button-backward-step");a&&a.addEventListener("click",(()=>{const t=M.querySelector(".is-active").nextElementSibling;t&&t.click()})),s&&s.addEventListener("click",(()=>{const t=M.querySelector(".is-active").previousElementSibling;t&&t.click()}))}()}();